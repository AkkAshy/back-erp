# üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Tasks App

## ‚úÖ –°—Ç–∞—Ç—É—Å: –í—Å—ë –≥–æ—Ç–æ–≤–æ!

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ tasks –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ —Å —Ñ–æ—Ç–æ-–æ—Ç—á—ë—Ç–∞–º–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–∑–¥–∞–Ω–æ.

---

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ê–∫—Ç–∏–≤–∏—Ä—É–π –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate

# 2. –°–æ–∑–¥–∞–π –º–∏–≥—Ä–∞—Ü–∏–∏
python manage.py makemigrations tasks

# 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
python manage.py migrate

# 4. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä
python manage.py runserver

# 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –≤ Swagger
http://localhost:8000/swagger/
```

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

```
tasks/
‚îú‚îÄ‚îÄ __init__.py           ‚úÖ
‚îú‚îÄ‚îÄ models.py             ‚úÖ 5 –º–æ–¥–µ–ª–µ–π (Task, Comment, Report, Photo, Template)
‚îú‚îÄ‚îÄ serializers.py        ‚úÖ 10 —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ views.py              ‚úÖ 4 ViewSet + 13 actions
‚îú‚îÄ‚îÄ urls.py               ‚úÖ REST API routing
‚îú‚îÄ‚îÄ admin.py              ‚úÖ Django admin —Å inlines
‚îú‚îÄ‚îÄ apps.py               ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è + signals
‚îú‚îÄ‚îÄ signals.py            ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ migrations/
    ‚îî‚îÄ‚îÄ __init__.py       ‚úÖ

config/
‚îú‚îÄ‚îÄ settings.py           ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ tasks.apps.TasksConfig
‚îî‚îÄ‚îÄ urls.py               ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω path('api/tasks/')
```

---

## üîå –û—Å–Ω–æ–≤–Ω—ã–µ endpoints:

```
# –ó–∞–¥–∞—á–∏
GET    /api/tasks/tasks/                     - –í—Å–µ –∑–∞–¥–∞—á–∏
POST   /api/tasks/tasks/                     - –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
GET    /api/tasks/tasks/{id}/                - –î–µ—Ç–∞–ª–∏
GET    /api/tasks/tasks/my_tasks/            - –ú–æ–∏ –∑–∞–¥–∞—á–∏
GET    /api/tasks/tasks/overdue/             - –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ
POST   /api/tasks/tasks/{id}/start/          - –ù–∞—á–∞—Ç—å
POST   /api/tasks/tasks/{id}/submit_for_review/  - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
POST   /api/tasks/tasks/{id}/approve/        - –û–¥–æ–±—Ä–∏—Ç—å
POST   /api/tasks/tasks/{id}/reject/         - –û—Ç–∫–ª–æ–Ω–∏—Ç—å

# –û—Ç—á—ë—Ç—ã —Å —Ñ–æ—Ç–æ
POST   /api/tasks/reports/                   - –°–æ–∑–¥–∞—Ç—å –æ—Ç—á—ë—Ç —Å —Ñ–æ—Ç–æ
GET    /api/tasks/reports/                   - –í—Å–µ –æ—Ç—á—ë—Ç—ã

# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
POST   /api/tasks/comments/                  - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
GET    /api/tasks/comments/                  - –í—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

# –®–∞–±–ª–æ–Ω—ã
GET    /api/tasks/templates/                 - –í—Å–µ —à–∞–±–ª–æ–Ω—ã
POST   /api/tasks/templates/{id}/create_task/  - –°–æ–∑–¥–∞—Ç—å –∏–∑ —à–∞–±–ª–æ–Ω–∞
```

---

## üéØ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Workflow)

### 1Ô∏è‚É£ –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É

```bash
POST /api/tasks/tasks/

{
  "title": "–ü—Ä–æ–≤–µ—Å—Ç–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—é —Å–∫–ª–∞–¥–∞",
  "description": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥–µ ‚Ññ1",
  "assigned_to": 5,
  "priority": "high",
  "category": "–°–∫–ª–∞–¥",
  "due_date": "2025-11-18T18:00:00Z",
  "estimated_hours": 4
}
```

**–°—Ç–∞—Ç—É—Å: pending**

---

### 2Ô∏è‚É£ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É

```bash
POST /api/tasks/tasks/1/start/
```

**–°—Ç–∞—Ç—É—Å: pending ‚Üí in_progress**

---

### 3Ô∏è‚É£ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á—ë—Ç —Å —Ñ–æ—Ç–æ

```bash
POST /api/tasks/reports/
Content-Type: multipart/form-data

task=1
description=–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í—Å–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã.
actual_hours=3.5
photos=@photo1.jpg
photos=@photo2.jpg
photos=@photo3.jpg
photo_captions=–°–∫–ª–∞–¥ –æ–±—â–∏–π –≤–∏–¥
photo_captions=–ê–∫—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏
photo_captions=–ü–æ–¥–ø–∏—Å–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ª–∏—Ü
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–æ–∑–¥–∞—ë—Ç—Å—è –æ—Ç—á—ë—Ç —Å 3 —Ñ–æ—Ç–æ
- –°—Ç–∞—Ç—É—Å: in_progress ‚Üí on_review

---

### 4Ô∏è‚É£ –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –æ–¥–æ–±—Ä—è–µ—Ç

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç—á—ë—Ç
GET /api/tasks/tasks/1/

# –û–¥–æ–±—Ä–∏—Ç—å
POST /api/tasks/tasks/1/approve/
```

**–°—Ç–∞—Ç—É—Å: on_review ‚Üí completed**

---

### üîÑ –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–∞

```bash
POST /api/tasks/tasks/1/reject/

{
  "reason": "–ù–µ –≤—Å–µ —Ñ–æ—Ç–æ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω—ã. –ù—É–∂–Ω–æ —Ñ–æ—Ç–æ —Å–µ–∫—Ü–∏–∏ –ë."
}
```

**–°—Ç–∞—Ç—É—Å: on_review ‚Üí rejected**

–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:
```bash
POST /api/tasks/comments/

{
  "task": 1,
  "text": "–§–æ—Ç–æ —Å–µ–∫—Ü–∏–∏ –ë –∑–∞–≥—Ä—É–∂—É –∑–∞–≤—Ç—Ä–∞, —Å–∫–ª–∞–¥ –±—ã–ª –∑–∞–∫—Ä—ã—Ç"
}
```

---

## üìä –ú–æ–¥–µ–ª–∏

### Task (–ó–∞–¥–∞—á–∞)
- **–°—Ç–∞—Ç—É—Å—ã:** pending, in_progress, on_review, completed, rejected, cancelled
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:** low, medium, high, urgent
- **–°–≤–æ–π—Å—Ç–≤–∞:** is_overdue, time_left

### TaskReport (–û—Ç—á—ë—Ç)
- description - –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
- actual_hours - —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è
- **photos** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ

### TaskReportPhoto (–§–æ—Ç–æ)
- photo - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (ImageField)
- caption - –ø–æ–¥–ø–∏—Å—å –∫ —Ñ–æ—Ç–æ
- **–ü—É—Ç—å:** `media/tasks/reports/{task_id}/photo.jpg`

### TaskComment (–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)
- text - —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
- author - –∞–≤—Ç–æ—Ä

### TaskTemplate (–®–∞–±–ª–æ–Ω)
- –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–¥–∞—á
- –ú–µ—Ç–æ–¥ `create_task()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω "–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —É–±–æ—Ä–∫–∞"

```bash
POST /api/tasks/templates/

{
  "title": "–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —É–±–æ—Ä–∫–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –∑–∞–ª–∞",
  "description": "1. –ü—Ä–æ—Ç–µ—Ä–µ—Ç—å –ø–æ–ª–∫–∏\n2. –ü–æ–º—ã—Ç—å –ø–æ–ª\n3. –í—ã–Ω–µ—Å—Ç–∏ –º—É—Å–æ—Ä",
  "category": "–£–±–æ—Ä–∫–∞",
  "priority": "medium",
  "estimated_hours": 1.5
}
```

### –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –∏–∑ —à–∞–±–ª–æ–Ω–∞

```bash
POST /api/tasks/templates/1/create_task/

{
  "assigned_to": 7,
  "due_date": "2025-11-17T09:00:00Z"
}
```

### –ü–æ–ª—É—á–∏—Ç—å –º–æ–∏ –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è

```bash
GET /api/tasks/tasks/my_tasks/?status=pending,in_progress
GET /api/tasks/tasks/today/
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∑–∞–¥–∞—á–∞–º

```bash
GET /api/tasks/tasks/stats/

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
{
  "total": 45,
  "by_status": {
    "pending": 12,
    "in_progress": 18,
    "on_review": 5,
    "completed": 8
  },
  "by_priority": {
    "urgent": 2,
    "high": 8,
    "medium": 25,
    "low": 10
  },
  "overdue": 3
}
```

---

## üîî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ß–µ—Ä–µ–∑ Django Signals –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

1. ‚úÖ **–°–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–º—É
2. ‚úÖ **–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é
3. ‚úÖ **–û–¥–æ–±—Ä–µ–Ω–∞** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
4. ‚úÖ **–û—Ç–∫–ª–æ–Ω–µ–Ω–∞** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é —Å –ø—Ä–∏—á–∏–Ω–æ–π
5. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
6. ‚úÖ **–û—Ç–ø—Ä–∞–≤–ª–µ–Ω –æ—Ç—á—ë—Ç** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é

---

## üîê –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

### –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (cashier, stockkeeper):
- –í–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏
- –ú–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏
- –ù–µ –º–æ–≥—É—Ç –æ–¥–æ–±—Ä—è—Ç—å/–æ—Ç–∫–ª–æ–Ω—è—Ç—å

### –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –∏ –≤–ª–∞–¥–µ–ª—å—Ü—ã:
- –í–∏–¥—è—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏
- –ú–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, –Ω–∞–∑–Ω–∞—á–∞—Ç—å, –æ–¥–æ–±—Ä—è—Ç—å, –æ—Ç–∫–ª–æ–Ω—è—Ç—å
- –ú–æ–≥—É—Ç –æ—Ç–º–µ–Ω—è—Ç—å –∑–∞–¥–∞—á–∏

---

## üì± –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
- JPEG, PNG, GIF, BMP

### –ü—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ (curl):

```bash
curl -X POST http://localhost:8000/api/tasks/reports/ \
  -H "Authorization: Bearer <token>" \
  -H "X-Tenant-Key: <key>" \
  -F "task=1" \
  -F "description=–†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞" \
  -F "actual_hours=2.5" \
  -F "photos=@photo1.jpg" \
  -F "photos=@photo2.jpg" \
  -F "photo_captions=–§–æ—Ç–æ 1" \
  -F "photo_captions=–§–æ—Ç–æ 2"
```

### –ü—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ (JavaScript):

```javascript
const formData = new FormData();
formData.append('task', taskId);
formData.append('description', '–†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞');
formData.append('actual_hours', 2.5);

// –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
photos.forEach(photo => {
  formData.append('photos', photo);
});

captions.forEach(caption => {
  formData.append('photo_captions', caption);
});

fetch('/api/tasks/reports/', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`,
    'X-Tenant-Key': tenantKey
  },
  body: formData
});
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

1. **–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç**:
   - `Authorization: Bearer <access_token>`
   - `X-Tenant-Key: <tenant_key>`

2. **–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ**:
   - Content-Type: `multipart/form-data`
   - –ü–æ–ª–µ `photos` - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤

3. **–°—Ç–∞—Ç—É—Å—ã –∏–∑–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**:
   - `start()` ‚Üí in_progress
   - `submit_for_review()` ‚Üí on_review (–ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç—á—ë—Ç–∞)
   - `approve()` ‚Üí completed
   - `reject()` ‚Üí rejected

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: [TASKS_GUIDE.md](TASKS_GUIDE.md)

---

**–í—Å—ë –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ! üéâ**

–ü—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –Ω–∞—á–∏–Ω–∞–π —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–¥–∞—á–∞–º–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞!
