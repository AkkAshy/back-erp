# üì¶ –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö

**–î–∞—Ç–∞:** 2025-11-20

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è –ø–æ X-Tenant-Key

–ü—Ä–æ–¥—É–∫—Ç—ã **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Tenant-Key`:

```
Middleware ‚Üí X-Tenant-Key ‚Üí switch search_path ‚Üí –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

**–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∑–∞–ø—Ä–æ—Å–µ!** –ü—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫.

---

## üìã –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π: –í–ª–∞–¥–µ–ª–µ—Ü —Å 2 –º–∞–≥–∞–∑–∏–Ω–∞–º–∏

```
–í–ª–∞–¥–µ–ª–µ—Ü: admin
–ú–∞–≥–∞–∑–∏–Ω A: test_shop (tenant_key: test_shop_4dfa7a5a)
–ú–∞–≥–∞–∑–∏–Ω B: asdawd (tenant_key: asdawd_8b43a536)
```

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ A

```bash
POST /api/products/products/
Authorization: Bearer <jwt_token>
X-Tenant-Key: test_shop_4dfa7a5a

{
  "name": "–ú–æ–ª–æ–∫–æ 1–ª",
  "description": "–°–≤–µ–∂–µ–µ –º–æ–ª–æ–∫–æ",
  "unit": 1,           # ID –µ–¥–∏–Ω–∏—Ü—ã –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ A
  "category": 3,       # ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ A
  "cost_price": 50,
  "sale_price": 70,
  "initial_quantity": 100
}

‚Üí Response:
{
  "id": 1,
  "name": "–ú–æ–ª–æ–∫–æ 1–ª",
  "tenant_key": "test_shop_4dfa7a5a",
  ...
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–æ–¥—É–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —Å—Ö–µ–º–µ `tenant_test_shop`
- ‚úÖ –¢–æ–ª—å–∫–æ –º–∞–≥–∞–∑–∏–Ω A –≤–∏–¥–∏—Ç —ç—Ç–æ—Ç –ø—Ä–æ–¥—É–∫—Ç
- ‚úÖ ID –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1 (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

### –ü—Ä–∏–º–µ—Ä 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ B

```bash
POST /api/products/products/
Authorization: Bearer <jwt_token>
X-Tenant-Key: asdawd_8b43a536

{
  "name": "–ú–æ–ª–æ–∫–æ 1–ª",    # –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫–æ–µ –∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ!
  "description": "–°–≤–µ–∂–µ–µ –º–æ–ª–æ–∫–æ",
  "unit": 1,              # ID –µ–¥–∏–Ω–∏—Ü—ã –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ B
  "category": 3,          # ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ B
  "cost_price": 45,       # –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥—Ä—É–≥–∞—è —Ü–µ–Ω–∞
  "sale_price": 65,
  "initial_quantity": 150
}

‚Üí Response:
{
  "id": 1,                # –¢–æ–∂–µ ID=1! (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
  "name": "–ú–æ–ª–æ–∫–æ 1–ª",
  "tenant_key": "asdawd_8b43a536",
  ...
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–æ–¥—É–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —Å—Ö–µ–º–µ `tenant_asdawd`
- ‚úÖ –¢–æ–ª—å–∫–æ –º–∞–≥–∞–∑–∏–Ω B –≤–∏–¥–∏—Ç —ç—Ç–æ—Ç –ø—Ä–æ–¥—É–∫—Ç
- ‚úÖ ID —Ç–æ–∂–µ 1 (—Å–≤–æ—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- ‚úÖ –ú–æ–∂–µ—Ç –±—ã—Ç—å **–æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ** –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ SKU

---

## üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

### –ú–∞–≥–∞–∑–∏–Ω A –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–≤–æ–∏ –ø—Ä–æ–¥—É–∫—Ç—ã

```bash
GET /api/products/products/
Authorization: Bearer <jwt_token>
X-Tenant-Key: test_shop_4dfa7a5a

‚Üí Response:
{
  "count": 5,
  "tenant_key": "test_shop_4dfa7a5a",
  "results": [
    {
      "id": 1,
      "name": "–ú–æ–ª–æ–∫–æ 1–ª",
      ...
    },
    {
      "id": 2,
      "name": "–•–ª–µ–± –±–µ–ª—ã–π",
      ...
    },
    // –¢–æ–ª—å–∫–æ –ø—Ä–æ–¥—É–∫—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ A
  ]
}
```

### –ú–∞–≥–∞–∑–∏–Ω B –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–≤–æ–∏ –ø—Ä–æ–¥—É–∫—Ç—ã

```bash
GET /api/products/products/
Authorization: Bearer <jwt_token>
X-Tenant-Key: asdawd_8b43a536

‚Üí Response:
{
  "count": 3,
  "tenant_key": "asdawd_8b43a536",
  "results": [
    {
      "id": 1,
      "name": "–ú–æ–ª–æ–∫–æ 1–ª",  # –î—Ä—É–≥–æ–π –ø—Ä–æ–¥—É–∫—Ç, –Ω–æ —Ç–æ –∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
      ...
    },
    {
      "id": 2,
      "name": "–°–∞—Ö–∞—Ä 1–∫–≥",
      ...
    },
    // –¢–æ–ª—å–∫–æ –ø—Ä–æ–¥—É–∫—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ B
  ]
}
```

---

## ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏–∏ –∏–∑–æ–ª—è—Ü–∏–∏

### –ß—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–æ:

1. ‚úÖ **–ü—Ä–æ–¥—É–∫—Ç—ã** - –ø–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è
2. ‚úÖ **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏** - –∫–∞–∂–¥—ã–π –º–∞–≥–∞–∑–∏–Ω –∏–º–µ–µ—Ç —Å–≤–æ–∏ (–∞–≤—Ç–æ—Å–æ–∑–¥–∞—é—Ç—Å—è 16 —à—Ç—É–∫)
3. ‚úÖ **–ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è** - –∫–∞–∂–¥—ã–π –º–∞–≥–∞–∑–∏–Ω –∏–º–µ–µ—Ç —Å–≤–æ–∏ (–∞–≤—Ç–æ—Å–æ–∑–¥–∞—é—Ç—Å—è 10 —à—Ç—É–∫)
4. ‚úÖ **–®—Ç—Ä–∏—Ö–∫–æ–¥—ã** - –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö
5. ‚úÖ **SKU** - –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö
6. ‚úÖ **–ü–∞—Ä—Ç–∏–∏** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã
7. ‚úÖ **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ** - –æ—Ç–¥–µ–ª—å–Ω—ã–π —É—á–µ—Ç

### –ß—Ç–æ –ù–ï –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–æ (shared):

1. ‚úÖ **User** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö
2. ‚úÖ **Store** - —Å–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤ –≤ public

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏

### –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ 1
curl -X POST http://localhost:8000/api/products/products/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Tenant-Key: store1_xxx" \
  -d '{"name":"Test Product", "unit":1, "category":1, "cost_price":100, "sale_price":150, "initial_quantity":50}'

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ 1 (–¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å)
curl -X GET http://localhost:8000/api/products/products/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Tenant-Key: store1_xxx"
# ‚Üí count: 1

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ 2 (–ù–ï –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å)
curl -X GET http://localhost:8000/api/products/products/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Tenant-Key: store2_xxx"
# ‚Üí count: 0

‚úÖ –ò–∑–æ–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

---

## üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏

### –í–ª–∞–¥–µ–ª–µ—Ü —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ –º–∞–≥–∞–∑–∏–Ω–∞–º–∏

```bash
# Login –æ–¥–∏–Ω —Ä–∞–∑
TOKEN=$(curl -X POST http://localhost:8000/api/users/auth/login/ \
  -d '{"username":"owner","password":"pass"}' | jq -r '.access')

# –†–∞–±–æ—Ç–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ A
curl -X GET http://localhost:8000/api/products/products/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Tenant-Key: store_a_xxx"
# ‚Üí –ø—Ä–æ–¥—É–∫—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ A

# –†–∞–±–æ—Ç–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ B (—Ç–æ—Ç –∂–µ —Ç–æ–∫–µ–Ω!)
curl -X GET http://localhost:8000/api/products/products/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Tenant-Key: store_b_xxx"
# ‚Üí –ø—Ä–æ–¥—É–∫—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ B
```

**–ü—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-Tenant-Key!**

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–∑–æ–ª—è—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  public schema  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ auth_user       ‚îÇ  ‚Üê –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (shared)
‚îÇ users_store     ‚îÇ  ‚Üê –ú–∞–≥–∞–∑–∏–Ω—ã (shared)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ tenant_test_shop schema ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ products_product        ‚îÇ  ‚Üê –ü—Ä–æ–¥—É–∫—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ A
‚îÇ products_category       ‚îÇ  ‚Üê –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ A
‚îÇ products_unit           ‚îÇ  ‚Üê –ï–¥–∏–Ω–∏—Ü—ã –º–∞–≥–∞–∑–∏–Ω–∞ A
‚îÇ products_productbatch   ‚îÇ  ‚Üê –ü–∞—Ä—Ç–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ A
‚îÇ ...                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ tenant_asdawd schema‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ products_product    ‚îÇ  ‚Üê –ü—Ä–æ–¥—É–∫—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ B
‚îÇ products_category   ‚îÇ  ‚Üê –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ B
‚îÇ products_unit       ‚îÇ  ‚Üê –ï–¥–∏–Ω–∏—Ü—ã –º–∞–≥–∞–∑–∏–Ω–∞ B
‚îÇ products_productbatch‚îÇ ‚Üê –ü–∞—Ä—Ç–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ B
‚îÇ ...                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç middleware:

```python
# 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å
POST /api/products/products/
X-Tenant-Key: test_shop_xxx

# 2. Middleware (core/middleware.py)
- –ù–∞—Ö–æ–¥–∏—Ç Store –ø–æ tenant_key
- –í—ã–ø–æ–ª–Ω—è–µ—Ç: SET search_path TO "tenant_test_shop", public
- –î–æ–±–∞–≤–ª—è–µ—Ç request.tenant = Store

# 3. View —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ
Product.objects.all()  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ö–µ–º–µ!

# 4. Response
- Middleware –¥–æ–±–∞–≤–ª—è–µ—Ç tenant_key –≤ response
- –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç search_path –æ–±—Ä–∞—Ç–Ω–æ –≤ public
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∏:

1. ‚úÖ **Permission IsTenantUser** - —Ç—Ä–µ–±—É–µ—Ç X-Tenant-Key
2. ‚úÖ **Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –º–∞–≥–∞–∑–∏–Ω—É
3. ‚úÖ **Database Router** - –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ö–µ–º—É
4. ‚úÖ **PostgreSQL –∏–∑–æ–ª—è—Ü–∏—è** - —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –ù–µ–ª—å–∑—è:

‚ùå –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã —á—É–∂–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
‚ùå –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç –±–µ–∑ X-Tenant-Key
‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å category/unit –∏–∑ –¥—Ä—É–≥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ (—Ä–∞–∑–Ω—ã–µ ID)

---

## üí° –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. ID –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω–æ

```
–ú–∞–≥–∞–∑–∏–Ω A: Product id=1 (–ú–æ–ª–æ–∫–æ)
–ú–∞–≥–∞–∑–∏–Ω B: Product id=1 (–•–ª–µ–±)  # –î—Ä—É–≥–æ–π –ø—Ä–æ–¥—É–∫—Ç!
```

**–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ tenant_key + product_id –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.**

### 2. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –µ–¥–∏–Ω–∏—Ü—ã —Ç–æ–∂–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã

```bash
# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ A
GET /api/products/categories/
X-Tenant-Key: store_a_xxx
# ‚Üí [{id: 1, name: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã"}, ...]

# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ B
GET /api/products/categories/
X-Tenant-Key: store_b_xxx
# ‚Üí [{id: 1, name: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã"}, ...]  # –¢–æ—Ç –∂–µ ID, –Ω–æ –¥—Ä—É–≥–∞—è –∑–∞–ø–∏—Å—å!
```

### 3. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ID –∏–∑ —Ç–æ–≥–æ –∂–µ –º–∞–≥–∞–∑–∏–Ω–∞

```bash
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
# –ü–æ–ª—É—á–∏—Ç—å category –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ A, —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ B

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
# –ü–æ–ª—É—á–∏—Ç—å category –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ B, —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ B
GET /api/products/categories/
X-Tenant-Key: store_b_xxx
# ‚Üí category_id: 5

POST /api/products/products/
X-Tenant-Key: store_b_xxx
{
  "category": 5,  # –¢–æ—Ç –∂–µ –º–∞–≥–∞–∑–∏–Ω!
  ...
}
```

---

## üéâ –ò—Ç–æ–≥–∏

### ‚úÖ –ß—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:

1. **–ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è** - –∫–∞–∂–¥—ã–π –º–∞–≥–∞–∑–∏–Ω –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ–¥—É–∫—Ç—ã
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è** - –Ω–µ –Ω—É–∂–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ, —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è** - —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ PostgreSQL —Å—Ö–µ–º
4. **–ü—Ä–æ—Å—Ç–∞—è** - –æ–¥–∏–Ω endpoint –¥–ª—è –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
5. **–ì–∏–±–∫–∞—è** - –º–æ–∂–Ω–æ –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è, SKU, —à—Ç—Ä–∏—Ö–∫–æ–¥—ã

### üìä –ü—Ä–∏–º–µ–Ω–∏–º–æ –∫–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º:

- ‚úÖ –ü—Ä–æ–¥—É–∫—Ç—ã (products)
- ‚úÖ –ü—Ä–æ–¥–∞–∂–∏ (sales)
- ‚úÖ –ö–ª–∏–µ–Ω—Ç—ã (customers)
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (analytics)
- ‚úÖ –ó–∞–¥–∞—á–∏ (tasks)
- ‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (employees)

**–í—Å–µ tenant-specific –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã!**

---

## üìö –°–º. —Ç–∞–∫–∂–µ

- [FINAL_ISOLATION_STATUS.md](FINAL_ISOLATION_STATUS.md) - –°—Ç–∞—Ç—É—Å –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- [MULTI_STORE_EMPLOYEES.md](MULTI_STORE_EMPLOYEES.md) - –†–∞–±–æ—Ç–∞ —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö
- [AUTO_DEFAULT_DATA.md](AUTO_DEFAULT_DATA.md) - –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –µ–¥–∏–Ω–∏—Ü
- [core/middleware.py](core/middleware.py) - Tenant middleware

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò
**–î–∞—Ç–∞:** 2025-11-20
